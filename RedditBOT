import praw
import time as tm

i = 0
j = 0

# First, login and client information for the bot is provided

reddit = praw.Reddit(
    client_id="",
    client_secret="",
    user_agent="",
    username="",
    password="")

# Define which subreddit(s) should be searched

subreddit = reddit.subreddit("Denmark+Aalborg+Aarhus+copenhagen+DanishEnts+Superligaen+Dankmark")
# subreddit = reddit.subreddit("botTestinganton")

# Define the comment the bot should post

botsentence = "Det hedder Aalborg, ikke Ålborg. Niarn og Hefty er skuffet!\n" \
              "\n \n" \
              "*Bip-Bop, jeg er en bot. Kontakt min skaber for ris/ros: u/neskire96*"

# List of users the bot doesn't reply to

sorteliste = ["AalborgBOT", "neskire96", "myresyre"]

start_time = tm.time()
for submission in subreddit.new(limit=500):  # Get the newest x submissions across the chosen subreddit(s)
    submission.comments.replace_more(limit=None)  # Get comments on all leves
    for comment in submission.comments.list():
        j += 1
        if str(comment.author) not in sorteliste:  # List of users the bot shouldn't reply
            if "ålborg" in comment.body.lower():
                comid = str(comment.id)
                with open("idlist.txt", "r+") as f:  # r+ is necessary for the script to read AND write to the txt file
                    if comid not in f.read():
                        f.write(comid + "\n")
                        print(50 * ".")
                        comment.reply(botsentence)
                        print("Replied to '" + comment.author.name + "' with the following comment:\n" + comment.body)
                        i += 1
    if "ålborg" in submission.title.lower() or "ålborg" in submission.selftext.lower():
        subid = str(submission.id)
        with open("idlist.txt", "r+") as f:
            if subid not in f.read():
                f.write(subid + "\n")
                print(50 * ".")
                submission.reply(botsentence)
                print("Replied to '" + str(submission.author) + "' with the following post:\n" + submission.title)
                i += 1

time = round((tm.time() - start_time))
print(50 * ".")
print("Done!", i, "correction(s) made in", j, "comments!")
print("Duration: %s seconds" % time)
